using System.Diagnostics;
using FluentAssertions;
using NUnit.Framework;

namespace FluentAlerts.Examples.Tests
{
    [TestFixture]
    public class CanSerialize
    {
        // Use http://dillinger.io/ to view markdown

        private static readonly TestCaseData[] GitHubMarkdownCases =
        {
            new TestCaseData(Mother.CreateMixedList(), "Still Experimental")
                .SetName("Enumerables - Experimental"),
            new TestCaseData(Mother.CreateTestObject(2), "Still Experimental")
                .SetName("Nested Classes - Experimental"),
            new TestCaseData(Mother.CreateTestStruct(2), "Still Experimental")
                .SetName("Nested Structs - Experimental"),
            new TestCaseData(Mother.CreateNestedException(2), "Still Experimental")
                .SetName("Exceptions - Experimental")
        };
        [Test, TestCaseSource("GitHubMarkdownCases")]
        public void WithGitHubMarkdownTemplate(object o, string expected)
        {
            Serialize(new FluentAlertSerializer<GitHubMarkdown>(), o, expected);
        }

        //Use http://www.cssdesk.com to view html

        private static readonly TestCaseData[] HtmlCases =
        {
            new TestCaseData(Mother.CreateMixedList(), @"<style type='text/css'> table.alert-table { font-family:Arial,Sans-Serif; font-size:8pt; background-color: #FFFFFF; } th.value-emphasized{ background-color: #E0E0E0; font-weight:bold; font-size:10pt; } td.value-title{ background-color: #A0A0A0; font-size:10pt; font-weight:bold; } td.value-emphasized{ background-color: #D0D0D0; font-weight:bold; } td.value-normal { background-color: #F0F0F0; } td#first-column.value-normal{ background-color: #E0E0E0; } </style><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>Object[]</TH></TR><TR><TD class='value-normal' id='first-column'>0</TD><TD class='value-normal' id='last-column'>Test String</TD></TR><TR><TD class='value-normal' id='first-column'>1</TD><TD class='value-normal' id='last-column'>12.2324</TD></TR><TR><TD class='value-normal' id='first-column'>2</TD><TD class='value-normal' id='last-column'>9149cae6-b300-44a7-8130-034f742477c4</TD></TR><TR><TD class='value-normal' id='first-column'>3</TD><TD class='value-normal' id='last-column'>1/1/2000 12:00:00 AM</TD></TR><TR><TD class='value-normal' id='first-column'>4</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>Tuple&LTString,String&GT</TH></TR><TR><TD class='value-normal' id='first-column'>Item1</TD><TD class='value-normal' id='last-column'>a</TD></TR><TR><TD class='value-normal' id='first-column'>Item2</TD><TD class='value-normal' id='last-column'>b</TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>5</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>Object[]</TH></TR><TR><TD class='value-normal' id='first-column'>0</TD><TD class='value-normal' id='last-column'>one</TD></TR><TR><TD class='value-normal' id='first-column'>1</TD><TD class='value-normal' id='last-column'>two</TD></TR><TR><TD class='value-normal' id='first-column'>2</TD><TD class='value-normal' id='last-column'>three</TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>6</TD><TD class='value-normal' id='last-column'>Empty String[]</TD></TR></table>")
                .SetName("Enumerables"),
            new TestCaseData(Mother.CreateTestObject(2), @"<style type='text/css'> table.alert-table { font-family:Arial,Sans-Serif; font-size:8pt; background-color: #FFFFFF; } th.value-emphasized{ background-color: #E0E0E0; font-weight:bold; font-size:10pt; } td.value-title{ background-color: #A0A0A0; font-size:10pt; font-weight:bold; } td.value-emphasized{ background-color: #D0D0D0; font-weight:bold; } td.value-normal { background-color: #F0F0F0; } td#first-column.value-normal{ background-color: #E0E0E0; } </style><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>TestClass</TH></TR><TR><TD class='value-normal' id='first-column'>DateProperty</TD><TD class='value-normal' id='last-column'>1/1/2000 12:00:00 AM</TD></TR><TR><TD class='value-normal' id='first-column'>NumberProperty</TD><TD class='value-normal' id='last-column'>Three</TD></TR><TR><TD class='value-normal' id='first-column'>InnerObject</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>TestClass</TH></TR><TR><TD class='value-normal' id='first-column'>DateProperty</TD><TD class='value-normal' id='last-column'>1/1/2000 12:00:00 AM</TD></TR><TR><TD class='value-normal' id='first-column'>NumberProperty</TD><TD class='value-normal' id='last-column'>Two</TD></TR><TR><TD class='value-normal' id='first-column'>InnerObject</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>TestClass</TH></TR><TR><TD class='value-normal' id='first-column'>DateProperty</TD><TD class='value-normal' id='last-column'>1/1/2000 12:00:00 AM</TD></TR><TR><TD class='value-normal' id='first-column'>NumberProperty</TD><TD class='value-normal' id='last-column'>One</TD></TR><TR><TD class='value-normal' id='first-column'>InnerObject</TD><TD class='value-normal' id='last-column'>Null</TD></TR><TR><TD class='value-normal' id='first-column'>InnerObjectList</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>Object[]</TH></TR><TR><TD class='value-normal' id='first-column'>0</TD><TD class='value-normal' id='last-column'>Test String</TD></TR><TR><TD class='value-normal' id='first-column'>1</TD><TD class='value-normal' id='last-column'>12.2324</TD></TR><TR><TD class='value-normal' id='first-column'>2</TD><TD class='value-normal' id='last-column'>9149cae6-b300-44a7-8130-034f742477c4</TD></TR><TR><TD class='value-normal' id='first-column'>3</TD><TD class='value-normal' id='last-column'>1/1/2000 12:00:00 AM</TD></TR><TR><TD class='value-normal' id='first-column'>4</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>Tuple&LTString,String&GT</TH></TR><TR><TD class='value-normal' id='first-column'>Item1</TD><TD class='value-normal' id='last-column'>a</TD></TR><TR><TD class='value-normal' id='first-column'>Item2</TD><TD class='value-normal' id='last-column'>b</TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>5</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>Object[]</TH></TR><TR><TD class='value-normal' id='first-column'>0</TD><TD class='value-normal' id='last-column'>one</TD></TR><TR><TD class='value-normal' id='first-column'>1</TD><TD class='value-normal' id='last-column'>two</TD></TR><TR><TD class='value-normal' id='first-column'>2</TD><TD class='value-normal' id='last-column'>three</TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>6</TD><TD class='value-normal' id='last-column'>Empty String[]</TD></TR></table></TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>InnerObjectList</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>Object[]</TH></TR><TR><TD class='value-normal' id='first-column'>0</TD><TD class='value-normal' id='last-column'>Test String</TD></TR><TR><TD class='value-normal' id='first-column'>1</TD><TD class='value-normal' id='last-column'>12.2324</TD></TR><TR><TD class='value-normal' id='first-column'>2</TD><TD class='value-normal' id='last-column'>9149cae6-b300-44a7-8130-034f742477c4</TD></TR><TR><TD class='value-normal' id='first-column'>3</TD><TD class='value-normal' id='last-column'>1/1/2000 12:00:00 AM</TD></TR><TR><TD class='value-normal' id='first-column'>4</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>Tuple&LTString,String&GT</TH></TR><TR><TD class='value-normal' id='first-column'>Item1</TD><TD class='value-normal' id='last-column'>a</TD></TR><TR><TD class='value-normal' id='first-column'>Item2</TD><TD class='value-normal' id='last-column'>b</TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>5</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>Object[]</TH></TR><TR><TD class='value-normal' id='first-column'>0</TD><TD class='value-normal' id='last-column'>one</TD></TR><TR><TD class='value-normal' id='first-column'>1</TD><TD class='value-normal' id='last-column'>two</TD></TR><TR><TD class='value-normal' id='first-column'>2</TD><TD class='value-normal' id='last-column'>three</TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>6</TD><TD class='value-normal' id='last-column'>Empty String[]</TD></TR></table></TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>InnerObjectList</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>Object[]</TH></TR><TR><TD class='value-normal' id='first-column'>0</TD><TD class='value-normal' id='last-column'>Test String</TD></TR><TR><TD class='value-normal' id='first-column'>1</TD><TD class='value-normal' id='last-column'>12.2324</TD></TR><TR><TD class='value-normal' id='first-column'>2</TD><TD class='value-normal' id='last-column'>9149cae6-b300-44a7-8130-034f742477c4</TD></TR><TR><TD class='value-normal' id='first-column'>3</TD><TD class='value-normal' id='last-column'>1/1/2000 12:00:00 AM</TD></TR><TR><TD class='value-normal' id='first-column'>4</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>Tuple&LTString,String&GT</TH></TR><TR><TD class='value-normal' id='first-column'>Item1</TD><TD class='value-normal' id='last-column'>a</TD></TR><TR><TD class='value-normal' id='first-column'>Item2</TD><TD class='value-normal' id='last-column'>b</TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>5</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>Object[]</TH></TR><TR><TD class='value-normal' id='first-column'>0</TD><TD class='value-normal' id='last-column'>one</TD></TR><TR><TD class='value-normal' id='first-column'>1</TD><TD class='value-normal' id='last-column'>two</TD></TR><TR><TD class='value-normal' id='first-column'>2</TD><TD class='value-normal' id='last-column'>three</TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>6</TD><TD class='value-normal' id='last-column'>Empty String[]</TD></TR></table></TD></TR></table>")
                .SetName("Nested Classes"),
            new TestCaseData(Mother.CreateTestStruct(2), @"<style type='text/css'> table.alert-table { font-family:Arial,Sans-Serif; font-size:8pt; background-color: #FFFFFF; } th.value-emphasized{ background-color: #E0E0E0; font-weight:bold; font-size:10pt; } td.value-title{ background-color: #A0A0A0; font-size:10pt; font-weight:bold; } td.value-emphasized{ background-color: #D0D0D0; font-weight:bold; } td.value-normal { background-color: #F0F0F0; } td#first-column.value-normal{ background-color: #E0E0E0; } </style><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>TestStruct</TH></TR><TR><TD class='value-normal' id='first-column'>DateProperty</TD><TD class='value-normal' id='last-column'>1/1/2000 12:00:00 AM</TD></TR><TR><TD class='value-normal' id='first-column'>NumberProperty</TD><TD class='value-normal' id='last-column'>Three</TD></TR><TR><TD class='value-normal' id='first-column'>InnerObjectList</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>Object[]</TH></TR><TR><TD class='value-normal' id='first-column'>0</TD><TD class='value-normal' id='last-column'>Test String</TD></TR><TR><TD class='value-normal' id='first-column'>1</TD><TD class='value-normal' id='last-column'>12.2324</TD></TR><TR><TD class='value-normal' id='first-column'>2</TD><TD class='value-normal' id='last-column'>9149cae6-b300-44a7-8130-034f742477c4</TD></TR><TR><TD class='value-normal' id='first-column'>3</TD><TD class='value-normal' id='last-column'>1/1/2000 12:00:00 AM</TD></TR><TR><TD class='value-normal' id='first-column'>4</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>Tuple&LTString,String&GT</TH></TR><TR><TD class='value-normal' id='first-column'>Item1</TD><TD class='value-normal' id='last-column'>a</TD></TR><TR><TD class='value-normal' id='first-column'>Item2</TD><TD class='value-normal' id='last-column'>b</TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>5</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>Object[]</TH></TR><TR><TD class='value-normal' id='first-column'>0</TD><TD class='value-normal' id='last-column'>one</TD></TR><TR><TD class='value-normal' id='first-column'>1</TD><TD class='value-normal' id='last-column'>two</TD></TR><TR><TD class='value-normal' id='first-column'>2</TD><TD class='value-normal' id='last-column'>three</TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>6</TD><TD class='value-normal' id='last-column'>Empty String[]</TD></TR></table></TD></TR></table>")
                .SetName("Nested Structs"),
            new TestCaseData(Mother.CreateNestedException(2), @"<style type='text/css'> table.alert-table { font-family:Arial,Sans-Serif; font-size:8pt; background-color: #FFFFFF; } th.value-emphasized{ background-color: #E0E0E0; font-weight:bold; font-size:10pt; } td.value-title{ background-color: #A0A0A0; font-size:10pt; font-weight:bold; } td.value-emphasized{ background-color: #D0D0D0; font-weight:bold; } td.value-normal { background-color: #F0F0F0; } td#first-column.value-normal{ background-color: #E0E0E0; } </style><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>ApplicationException</TH></TR><TR><TD class='value-normal' id='first-column'>Message</TD><TD class='value-normal' id='last-column'>Exception Message at Depth 0</TD></TR><TR><TD class='value-normal' id='first-column'>InnerException</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>ApplicationException</TH></TR><TR><TD class='value-normal' id='first-column'>Message</TD><TD class='value-normal' id='last-column'>Exception Message at Depth 1</TD></TR><TR><TD class='value-normal' id='first-column'>InnerException</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>ApplicationException</TH></TR><TR><TD class='value-normal' id='first-column'>Message</TD><TD class='value-normal' id='last-column'>Exception Message at Depth 2</TD></TR><TR><TD class='value-normal' id='first-column'>InnerException</TD><TD class='value-normal' id='last-column'>Null</TD></TR><TR><TD class='value-normal' id='first-column'>StackTrace</TD><TD class='value-normal' id='last-column'>   at FluentAlerts.Examples.Mother.ThrowNestedException(Int32 nestingDepth, Int32 maxDepth) in c:\Source\FluentAlerts\FluentAlerts.Examples\Mother.cs:line 69
   at FluentAlerts.Examples.Mother.ThrowNestedException(Int32 nestingDepth, Int32 maxDepth) in c:\Source\FluentAlerts\FluentAlerts.Examples\Mother.cs:line 75</TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>StackTrace</TD><TD class='value-normal' id='last-column'>   at FluentAlerts.Examples.Mother.ThrowNestedException(Int32 nestingDepth, Int32 maxDepth) in c:\Source\FluentAlerts\FluentAlerts.Examples\Mother.cs:line 81
   at FluentAlerts.Examples.Mother.ThrowNestedException(Int32 nestingDepth, Int32 maxDepth) in c:\Source\FluentAlerts\FluentAlerts.Examples\Mother.cs:line 75</TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>StackTrace</TD><TD class='value-normal' id='last-column'>   at FluentAlerts.Examples.Mother.ThrowNestedException(Int32 nestingDepth, Int32 maxDepth) in c:\Source\FluentAlerts\FluentAlerts.Examples\Mother.cs:line 81
   at FluentAlerts.Examples.Mother.CreateNestedException(Int32 nestingDepth) in c:\Source\FluentAlerts\FluentAlerts.Examples\Mother.cs:line 53</TD></TR></table>")
                .SetName("Exceptions")
        };
        [Test, TestCaseSource("HtmlCases")]
        public void WithHtmlTemplate(object o, string expected)
        {
            Serialize(new FluentAlertSerializer<Html>(), o , expected);
        }


        private static readonly TestCaseData[] OutlookCases =
        {
            new TestCaseData(Mother.CreateMixedList(), "<html><body bgcolor='white' style='color:black;padding-top:0px;padding-bottom:0px;margin-top:0px;margin-bottom:0px;'><table cellpadding='0' style='border-style:solid;border-width:1px;border-color:black;font-family:Arial,Sans-Serif;font-size:9pt;' width='100%'><TR><TH style='background-color:silver;font-weight:bold;font-size:10pt;' colspan='2'>Object[]</TH></TR><TR><TD style='background-color:whitesmoke;'>0</TD><TD style='background-color:whitesmoke;'>Test String</TD></TR><TR><TD style='background-color:whitesmoke;'>1</TD><TD style='background-color:whitesmoke;'>12.2324</TD></TR><TR><TD style='background-color:whitesmoke;'>2</TD><TD style='background-color:whitesmoke;'>9149cae6-b300-44a7-8130-034f742477c4</TD></TR><TR><TD style='background-color:whitesmoke;'>3</TD><TD style='background-color:whitesmoke;'>1/1/2000 12:00:00 AM</TD></TR><TR><TD style='background-color:whitesmoke;'>4</TD><TD style='background-color:whitesmoke;'><table cellpadding='0' style='border-style:solid;border-width:1px;border-color:black;font-family:Arial,Sans-Serif;font-size:9pt;' width='100%'><TR><TH style='background-color:silver;font-weight:bold;font-size:10pt;' colspan='2'>Tuple&LTString,String&GT</TH></TR><TR><TD style='background-color:whitesmoke;'>Item1</TD><TD style='background-color:whitesmoke;'>a</TD></TR><TR><TD style='background-color:whitesmoke;'>Item2</TD><TD style='background-color:whitesmoke;'>b</TD></TR></table></TD></TR><TR><TD style='background-color:whitesmoke;'>5</TD><TD style='background-color:whitesmoke;'><table cellpadding='0' style='border-style:solid;border-width:1px;border-color:black;font-family:Arial,Sans-Serif;font-size:9pt;' width='100%'><TR><TH style='background-color:silver;font-weight:bold;font-size:10pt;' colspan='2'>Object[]</TH></TR><TR><TD style='background-color:whitesmoke;'>0</TD><TD style='background-color:whitesmoke;'>one</TD></TR><TR><TD style='background-color:whitesmoke;'>1</TD><TD style='background-color:whitesmoke;'>two</TD></TR><TR><TD style='background-color:whitesmoke;'>2</TD><TD style='background-color:whitesmoke;'>three</TD></TR></table></TD></TR><TR><TD style='background-color:whitesmoke;'>6</TD><TD style='background-color:whitesmoke;'>Empty String[]</TD></TR></table></body></html>")
                .SetName("Enumerables"),
            new TestCaseData(Mother.CreateTestObject(2), "<html><body bgcolor='white' style='color:black;padding-top:0px;padding-bottom:0px;margin-top:0px;margin-bottom:0px;'><table cellpadding='0' style='border-style:solid;border-width:1px;border-color:black;font-family:Arial,Sans-Serif;font-size:9pt;' width='100%'><TR><TH style='background-color:silver;font-weight:bold;font-size:10pt;' colspan='2'>TestClass</TH></TR><TR><TD style='background-color:whitesmoke;'>DateProperty</TD><TD style='background-color:whitesmoke;'>1/1/2000 12:00:00 AM</TD></TR><TR><TD style='background-color:whitesmoke;'>NumberProperty</TD><TD style='background-color:whitesmoke;'>Three</TD></TR><TR><TD style='background-color:whitesmoke;'>InnerObject</TD><TD style='background-color:whitesmoke;'><table cellpadding='0' style='border-style:solid;border-width:1px;border-color:black;font-family:Arial,Sans-Serif;font-size:9pt;' width='100%'><TR><TH style='background-color:silver;font-weight:bold;font-size:10pt;' colspan='2'>TestClass</TH></TR><TR><TD style='background-color:whitesmoke;'>DateProperty</TD><TD style='background-color:whitesmoke;'>1/1/2000 12:00:00 AM</TD></TR><TR><TD style='background-color:whitesmoke;'>NumberProperty</TD><TD style='background-color:whitesmoke;'>Two</TD></TR><TR><TD style='background-color:whitesmoke;'>InnerObject</TD><TD style='background-color:whitesmoke;'><table cellpadding='0' style='border-style:solid;border-width:1px;border-color:black;font-family:Arial,Sans-Serif;font-size:9pt;' width='100%'><TR><TH style='background-color:silver;font-weight:bold;font-size:10pt;' colspan='2'>TestClass</TH></TR><TR><TD style='background-color:whitesmoke;'>DateProperty</TD><TD style='background-color:whitesmoke;'>1/1/2000 12:00:00 AM</TD></TR><TR><TD style='background-color:whitesmoke;'>NumberProperty</TD><TD style='background-color:whitesmoke;'>One</TD></TR><TR><TD style='background-color:whitesmoke;'>InnerObject</TD><TD style='background-color:whitesmoke;'>Null</TD></TR><TR><TD style='background-color:whitesmoke;'>InnerObjectList</TD><TD style='background-color:whitesmoke;'><table cellpadding='0' style='border-style:solid;border-width:1px;border-color:black;font-family:Arial,Sans-Serif;font-size:9pt;' width='100%'><TR><TH style='background-color:silver;font-weight:bold;font-size:10pt;' colspan='2'>Object[]</TH></TR><TR><TD style='background-color:whitesmoke;'>0</TD><TD style='background-color:whitesmoke;'>Test String</TD></TR><TR><TD style='background-color:whitesmoke;'>1</TD><TD style='background-color:whitesmoke;'>12.2324</TD></TR><TR><TD style='background-color:whitesmoke;'>2</TD><TD style='background-color:whitesmoke;'>9149cae6-b300-44a7-8130-034f742477c4</TD></TR><TR><TD style='background-color:whitesmoke;'>3</TD><TD style='background-color:whitesmoke;'>1/1/2000 12:00:00 AM</TD></TR><TR><TD style='background-color:whitesmoke;'>4</TD><TD style='background-color:whitesmoke;'><table cellpadding='0' style='border-style:solid;border-width:1px;border-color:black;font-family:Arial,Sans-Serif;font-size:9pt;' width='100%'><TR><TH style='background-color:silver;font-weight:bold;font-size:10pt;' colspan='2'>Tuple&LTString,String&GT</TH></TR><TR><TD style='background-color:whitesmoke;'>Item1</TD><TD style='background-color:whitesmoke;'>a</TD></TR><TR><TD style='background-color:whitesmoke;'>Item2</TD><TD style='background-color:whitesmoke;'>b</TD></TR></table></TD></TR><TR><TD style='background-color:whitesmoke;'>5</TD><TD style='background-color:whitesmoke;'><table cellpadding='0' style='border-style:solid;border-width:1px;border-color:black;font-family:Arial,Sans-Serif;font-size:9pt;' width='100%'><TR><TH style='background-color:silver;font-weight:bold;font-size:10pt;' colspan='2'>Object[]</TH></TR><TR><TD style='background-color:whitesmoke;'>0</TD><TD style='background-color:whitesmoke;'>one</TD></TR><TR><TD style='background-color:whitesmoke;'>1</TD><TD style='background-color:whitesmoke;'>two</TD></TR><TR><TD style='background-color:whitesmoke;'>2</TD><TD style='background-color:whitesmoke;'>three</TD></TR></table></TD></TR><TR><TD style='background-color:whitesmoke;'>6</TD><TD style='background-color:whitesmoke;'>Empty String[]</TD></TR></table></TD></TR></table></TD></TR><TR><TD style='background-color:whitesmoke;'>InnerObjectList</TD><TD style='background-color:whitesmoke;'><table cellpadding='0' style='border-style:solid;border-width:1px;border-color:black;font-family:Arial,Sans-Serif;font-size:9pt;' width='100%'><TR><TH style='background-color:silver;font-weight:bold;font-size:10pt;' colspan='2'>Object[]</TH></TR><TR><TD style='background-color:whitesmoke;'>0</TD><TD style='background-color:whitesmoke;'>Test String</TD></TR><TR><TD style='background-color:whitesmoke;'>1</TD><TD style='background-color:whitesmoke;'>12.2324</TD></TR><TR><TD style='background-color:whitesmoke;'>2</TD><TD style='background-color:whitesmoke;'>9149cae6-b300-44a7-8130-034f742477c4</TD></TR><TR><TD style='background-color:whitesmoke;'>3</TD><TD style='background-color:whitesmoke;'>1/1/2000 12:00:00 AM</TD></TR><TR><TD style='background-color:whitesmoke;'>4</TD><TD style='background-color:whitesmoke;'><table cellpadding='0' style='border-style:solid;border-width:1px;border-color:black;font-family:Arial,Sans-Serif;font-size:9pt;' width='100%'><TR><TH style='background-color:silver;font-weight:bold;font-size:10pt;' colspan='2'>Tuple&LTString,String&GT</TH></TR><TR><TD style='background-color:whitesmoke;'>Item1</TD><TD style='background-color:whitesmoke;'>a</TD></TR><TR><TD style='background-color:whitesmoke;'>Item2</TD><TD style='background-color:whitesmoke;'>b</TD></TR></table></TD></TR><TR><TD style='background-color:whitesmoke;'>5</TD><TD style='background-color:whitesmoke;'><table cellpadding='0' style='border-style:solid;border-width:1px;border-color:black;font-family:Arial,Sans-Serif;font-size:9pt;' width='100%'><TR><TH style='background-color:silver;font-weight:bold;font-size:10pt;' colspan='2'>Object[]</TH></TR><TR><TD style='background-color:whitesmoke;'>0</TD><TD style='background-color:whitesmoke;'>one</TD></TR><TR><TD style='background-color:whitesmoke;'>1</TD><TD style='background-color:whitesmoke;'>two</TD></TR><TR><TD style='background-color:whitesmoke;'>2</TD><TD style='background-color:whitesmoke;'>three</TD></TR></table></TD></TR><TR><TD style='background-color:whitesmoke;'>6</TD><TD style='background-color:whitesmoke;'>Empty String[]</TD></TR></table></TD></TR></table></TD></TR><TR><TD style='background-color:whitesmoke;'>InnerObjectList</TD><TD style='background-color:whitesmoke;'><table cellpadding='0' style='border-style:solid;border-width:1px;border-color:black;font-family:Arial,Sans-Serif;font-size:9pt;' width='100%'><TR><TH style='background-color:silver;font-weight:bold;font-size:10pt;' colspan='2'>Object[]</TH></TR><TR><TD style='background-color:whitesmoke;'>0</TD><TD style='background-color:whitesmoke;'>Test String</TD></TR><TR><TD style='background-color:whitesmoke;'>1</TD><TD style='background-color:whitesmoke;'>12.2324</TD></TR><TR><TD style='background-color:whitesmoke;'>2</TD><TD style='background-color:whitesmoke;'>9149cae6-b300-44a7-8130-034f742477c4</TD></TR><TR><TD style='background-color:whitesmoke;'>3</TD><TD style='background-color:whitesmoke;'>1/1/2000 12:00:00 AM</TD></TR><TR><TD style='background-color:whitesmoke;'>4</TD><TD style='background-color:whitesmoke;'><table cellpadding='0' style='border-style:solid;border-width:1px;border-color:black;font-family:Arial,Sans-Serif;font-size:9pt;' width='100%'><TR><TH style='background-color:silver;font-weight:bold;font-size:10pt;' colspan='2'>Tuple&LTString,String&GT</TH></TR><TR><TD style='background-color:whitesmoke;'>Item1</TD><TD style='background-color:whitesmoke;'>a</TD></TR><TR><TD style='background-color:whitesmoke;'>Item2</TD><TD style='background-color:whitesmoke;'>b</TD></TR></table></TD></TR><TR><TD style='background-color:whitesmoke;'>5</TD><TD style='background-color:whitesmoke;'><table cellpadding='0' style='border-style:solid;border-width:1px;border-color:black;font-family:Arial,Sans-Serif;font-size:9pt;' width='100%'><TR><TH style='background-color:silver;font-weight:bold;font-size:10pt;' colspan='2'>Object[]</TH></TR><TR><TD style='background-color:whitesmoke;'>0</TD><TD style='background-color:whitesmoke;'>one</TD></TR><TR><TD style='background-color:whitesmoke;'>1</TD><TD style='background-color:whitesmoke;'>two</TD></TR><TR><TD style='background-color:whitesmoke;'>2</TD><TD style='background-color:whitesmoke;'>three</TD></TR></table></TD></TR><TR><TD style='background-color:whitesmoke;'>6</TD><TD style='background-color:whitesmoke;'>Empty String[]</TD></TR></table></TD></TR></table></body></html>")
                .SetName("Nested Classes"),
            new TestCaseData(Mother.CreateTestStruct(2), "<html><body bgcolor='white' style='color:black;padding-top:0px;padding-bottom:0px;margin-top:0px;margin-bottom:0px;'><table cellpadding='0' style='border-style:solid;border-width:1px;border-color:black;font-family:Arial,Sans-Serif;font-size:9pt;' width='100%'><TR><TH style='background-color:silver;font-weight:bold;font-size:10pt;' colspan='2'>TestStruct</TH></TR><TR><TD style='background-color:whitesmoke;'>DateProperty</TD><TD style='background-color:whitesmoke;'>1/1/2000 12:00:00 AM</TD></TR><TR><TD style='background-color:whitesmoke;'>NumberProperty</TD><TD style='background-color:whitesmoke;'>Three</TD></TR><TR><TD style='background-color:whitesmoke;'>InnerObjectList</TD><TD style='background-color:whitesmoke;'><table cellpadding='0' style='border-style:solid;border-width:1px;border-color:black;font-family:Arial,Sans-Serif;font-size:9pt;' width='100%'><TR><TH style='background-color:silver;font-weight:bold;font-size:10pt;' colspan='2'>Object[]</TH></TR><TR><TD style='background-color:whitesmoke;'>0</TD><TD style='background-color:whitesmoke;'>Test String</TD></TR><TR><TD style='background-color:whitesmoke;'>1</TD><TD style='background-color:whitesmoke;'>12.2324</TD></TR><TR><TD style='background-color:whitesmoke;'>2</TD><TD style='background-color:whitesmoke;'>9149cae6-b300-44a7-8130-034f742477c4</TD></TR><TR><TD style='background-color:whitesmoke;'>3</TD><TD style='background-color:whitesmoke;'>1/1/2000 12:00:00 AM</TD></TR><TR><TD style='background-color:whitesmoke;'>4</TD><TD style='background-color:whitesmoke;'><table cellpadding='0' style='border-style:solid;border-width:1px;border-color:black;font-family:Arial,Sans-Serif;font-size:9pt;' width='100%'><TR><TH style='background-color:silver;font-weight:bold;font-size:10pt;' colspan='2'>Tuple&LTString,String&GT</TH></TR><TR><TD style='background-color:whitesmoke;'>Item1</TD><TD style='background-color:whitesmoke;'>a</TD></TR><TR><TD style='background-color:whitesmoke;'>Item2</TD><TD style='background-color:whitesmoke;'>b</TD></TR></table></TD></TR><TR><TD style='background-color:whitesmoke;'>5</TD><TD style='background-color:whitesmoke;'><table cellpadding='0' style='border-style:solid;border-width:1px;border-color:black;font-family:Arial,Sans-Serif;font-size:9pt;' width='100%'><TR><TH style='background-color:silver;font-weight:bold;font-size:10pt;' colspan='2'>Object[]</TH></TR><TR><TD style='background-color:whitesmoke;'>0</TD><TD style='background-color:whitesmoke;'>one</TD></TR><TR><TD style='background-color:whitesmoke;'>1</TD><TD style='background-color:whitesmoke;'>two</TD></TR><TR><TD style='background-color:whitesmoke;'>2</TD><TD style='background-color:whitesmoke;'>three</TD></TR></table></TD></TR><TR><TD style='background-color:whitesmoke;'>6</TD><TD style='background-color:whitesmoke;'>Empty String[]</TD></TR></table></TD></TR></table></body></html>")
                .SetName("Nested Structs"),
            new TestCaseData(Mother.CreateNestedException(2), @"<html><body bgcolor='white' style='color:black;padding-top:0px;padding-bottom:0px;margin-top:0px;margin-bottom:0px;'><table cellpadding='0' style='border-style:solid;border-width:1px;border-color:black;font-family:Arial,Sans-Serif;font-size:9pt;' width='100%'><TR><TH style='background-color:silver;font-weight:bold;font-size:10pt;' colspan='2'>ApplicationException</TH></TR><TR><TD style='background-color:whitesmoke;'>Message</TD><TD style='background-color:whitesmoke;'>Exception Message at Depth 0</TD></TR><TR><TD style='background-color:whitesmoke;'>InnerException</TD><TD style='background-color:whitesmoke;'><table cellpadding='0' style='border-style:solid;border-width:1px;border-color:black;font-family:Arial,Sans-Serif;font-size:9pt;' width='100%'><TR><TH style='background-color:silver;font-weight:bold;font-size:10pt;' colspan='2'>ApplicationException</TH></TR><TR><TD style='background-color:whitesmoke;'>Message</TD><TD style='background-color:whitesmoke;'>Exception Message at Depth 1</TD></TR><TR><TD style='background-color:whitesmoke;'>InnerException</TD><TD style='background-color:whitesmoke;'><table cellpadding='0' style='border-style:solid;border-width:1px;border-color:black;font-family:Arial,Sans-Serif;font-size:9pt;' width='100%'><TR><TH style='background-color:silver;font-weight:bold;font-size:10pt;' colspan='2'>ApplicationException</TH></TR><TR><TD style='background-color:whitesmoke;'>Message</TD><TD style='background-color:whitesmoke;'>Exception Message at Depth 2</TD></TR><TR><TD style='background-color:whitesmoke;'>InnerException</TD><TD style='background-color:whitesmoke;'>Null</TD></TR><TR><TD style='background-color:whitesmoke;'>StackTrace</TD><TD style='background-color:whitesmoke;'>   at FluentAlerts.Examples.Mother.ThrowNestedException(Int32 nestingDepth, Int32 maxDepth) in c:\Source\FluentAlerts\FluentAlerts.Examples\Mother.cs:line 69
   at FluentAlerts.Examples.Mother.ThrowNestedException(Int32 nestingDepth, Int32 maxDepth) in c:\Source\FluentAlerts\FluentAlerts.Examples\Mother.cs:line 75</TD></TR></table></TD></TR><TR><TD style='background-color:whitesmoke;'>StackTrace</TD><TD style='background-color:whitesmoke;'>   at FluentAlerts.Examples.Mother.ThrowNestedException(Int32 nestingDepth, Int32 maxDepth) in c:\Source\FluentAlerts\FluentAlerts.Examples\Mother.cs:line 81
   at FluentAlerts.Examples.Mother.ThrowNestedException(Int32 nestingDepth, Int32 maxDepth) in c:\Source\FluentAlerts\FluentAlerts.Examples\Mother.cs:line 75</TD></TR></table></TD></TR><TR><TD style='background-color:whitesmoke;'>StackTrace</TD><TD style='background-color:whitesmoke;'>   at FluentAlerts.Examples.Mother.ThrowNestedException(Int32 nestingDepth, Int32 maxDepth) in c:\Source\FluentAlerts\FluentAlerts.Examples\Mother.cs:line 81
   at FluentAlerts.Examples.Mother.CreateNestedException(Int32 nestingDepth) in c:\Source\FluentAlerts\FluentAlerts.Examples\Mother.cs:line 53</TD></TR></table></body></html>")
                .SetName("Exceptions")
        };
        [Test, TestCaseSource("OutlookCases")]
        public void WithOutlookTemplate(object o, string expected)
        {
            Serialize(new FluentAlertSerializer<Outlook>(), o, expected);
        }


        private static void Serialize(IFluentAlertSerializer serializer, object o, string expected)
        {
            var actual = serializer.Serialize(o);
            Debug.Print(actual);
            actual.Should().Be(expected);
        }
    }
}
