using System.Diagnostics;
using FluentAssertions;
using NUnit.Framework;

namespace FluentAlerts.Examples.Tests
{
    [TestFixture]
    public class CanSerialize
    {

        private static readonly TestCaseData[] BaseCases =
        {
            new TestCaseData(Mother.CreateMixedList(), "Object[]")
                .SetName("Enumerables"),
            new TestCaseData(Mother.CreateTestObject(2), "TestClass")
                .SetName("Nested Classes"),
            new TestCaseData(Mother.CreateTestStruct(2), "TestStruct")
                .SetName("Nested Structs")
        };
        [Test, TestCaseSource("BaseCases")]
        public void WithBaseTemplate(object o, string expected)
        {
            Serialize(new FluentAlertSerializer<FluentAlertSerializerTemplate>(), o, expected);
        }

        private static readonly TestCaseData[] HtmlCases =
        {
            new TestCaseData(Mother.CreateMixedList(), "<style type='text/css'> table.alert-table { font-family:Arial,Sans-Serif; font-size:8pt; background-color: #FFFFFF; } th.value-emphasized{ background-color: #E0E0E0; font-weight:bold; font-size:10pt; } td.value-title{ background-color: #A0A0A0; font-size:10pt; font-weight:bold; } td.value-emphasized{ background-color: #D0D0D0; font-weight:bold; } td.value-normal { background-color: #F0F0F0; } td#first-column.value-normal{ background-color: #E0E0E0; } </style><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>Object[]</TH></TR><TR><TD class='value-normal' id='first-column'>0</TD><TD class='value-normal' id='last-column'>Test String</TD></TR><TR><TD class='value-normal' id='first-column'>1</TD><TD class='value-normal' id='last-column'>12.2324</TD></TR><TR><TD class='value-normal' id='first-column'>2</TD><TD class='value-normal' id='last-column'>9149cae6-b300-44a7-8130-034f742477c4</TD></TR><TR><TD class='value-normal' id='first-column'>3</TD><TD class='value-normal' id='last-column'>1/1/2000 12:00:00 AM</TD></TR><TR><TD class='value-normal' id='first-column'>4</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>Tuple&LTString,String&GT</TH></TR><TR><TD class='value-normal' id='first-column'>Item1</TD><TD class='value-normal' id='last-column'>a</TD></TR><TR><TD class='value-normal' id='first-column'>Item2</TD><TD class='value-normal' id='last-column'>b</TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>5</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>String[]</TH></TR><TR><TD class='value-normal' id='first-column'>0</TD><TD class='value-normal' id='last-column'>one</TD></TR><TR><TD class='value-normal' id='first-column'>1</TD><TD class='value-normal' id='last-column'>two</TD></TR><TR><TD class='value-normal' id='first-column'>2</TD><TD class='value-normal' id='last-column'>three</TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>6</TD><TD class='value-normal' id='last-column'>Empty String[]</TD></TR></table>")
                .SetName("Enumerables"),
            new TestCaseData(Mother.CreateTestObject(2), "<style type='text/css'> table.alert-table { font-family:Arial,Sans-Serif; font-size:8pt; background-color: #FFFFFF; } th.value-emphasized{ background-color: #E0E0E0; font-weight:bold; font-size:10pt; } td.value-title{ background-color: #A0A0A0; font-size:10pt; font-weight:bold; } td.value-emphasized{ background-color: #D0D0D0; font-weight:bold; } td.value-normal { background-color: #F0F0F0; } td#first-column.value-normal{ background-color: #E0E0E0; } </style><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>TestClass</TH></TR><TR><TD class='value-normal' id='first-column'>DateProperty</TD><TD class='value-normal' id='last-column'>1/1/2000 12:00:00 AM</TD></TR><TR><TD class='value-normal' id='first-column'>NumberProperty</TD><TD class='value-normal' id='last-column'>Three</TD></TR><TR><TD class='value-normal' id='first-column'>InnerObject</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>TestClass</TH></TR><TR><TD class='value-normal' id='first-column'>DateProperty</TD><TD class='value-normal' id='last-column'>1/1/2000 12:00:00 AM</TD></TR><TR><TD class='value-normal' id='first-column'>NumberProperty</TD><TD class='value-normal' id='last-column'>Two</TD></TR><TR><TD class='value-normal' id='first-column'>InnerObject</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>TestClass</TH></TR><TR><TD class='value-normal' id='first-column'>DateProperty</TD><TD class='value-normal' id='last-column'>1/1/2000 12:00:00 AM</TD></TR><TR><TD class='value-normal' id='first-column'>NumberProperty</TD><TD class='value-normal' id='last-column'>One</TD></TR><TR><TD class='value-normal' id='first-column'>InnerObject</TD><TD class='value-normal' id='last-column'>Null</TD></TR><TR><TD class='value-normal' id='first-column'>InnerObjectList</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>Object[]</TH></TR><TR><TD class='value-normal' id='first-column'>0</TD><TD class='value-normal' id='last-column'>Test String</TD></TR><TR><TD class='value-normal' id='first-column'>1</TD><TD class='value-normal' id='last-column'>12.2324</TD></TR><TR><TD class='value-normal' id='first-column'>2</TD><TD class='value-normal' id='last-column'>9149cae6-b300-44a7-8130-034f742477c4</TD></TR><TR><TD class='value-normal' id='first-column'>3</TD><TD class='value-normal' id='last-column'>1/1/2000 12:00:00 AM</TD></TR><TR><TD class='value-normal' id='first-column'>4</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>Tuple&LTString,String&GT</TH></TR><TR><TD class='value-normal' id='first-column'>Item1</TD><TD class='value-normal' id='last-column'>a</TD></TR><TR><TD class='value-normal' id='first-column'>Item2</TD><TD class='value-normal' id='last-column'>b</TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>5</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>String[]</TH></TR><TR><TD class='value-normal' id='first-column'>0</TD><TD class='value-normal' id='last-column'>one</TD></TR><TR><TD class='value-normal' id='first-column'>1</TD><TD class='value-normal' id='last-column'>two</TD></TR><TR><TD class='value-normal' id='first-column'>2</TD><TD class='value-normal' id='last-column'>three</TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>6</TD><TD class='value-normal' id='last-column'>Empty String[]</TD></TR></table></TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>InnerObjectList</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>Object[]</TH></TR><TR><TD class='value-normal' id='first-column'>0</TD><TD class='value-normal' id='last-column'>Test String</TD></TR><TR><TD class='value-normal' id='first-column'>1</TD><TD class='value-normal' id='last-column'>12.2324</TD></TR><TR><TD class='value-normal' id='first-column'>2</TD><TD class='value-normal' id='last-column'>9149cae6-b300-44a7-8130-034f742477c4</TD></TR><TR><TD class='value-normal' id='first-column'>3</TD><TD class='value-normal' id='last-column'>1/1/2000 12:00:00 AM</TD></TR><TR><TD class='value-normal' id='first-column'>4</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>Tuple&LTString,String&GT</TH></TR><TR><TD class='value-normal' id='first-column'>Item1</TD><TD class='value-normal' id='last-column'>a</TD></TR><TR><TD class='value-normal' id='first-column'>Item2</TD><TD class='value-normal' id='last-column'>b</TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>5</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>String[]</TH></TR><TR><TD class='value-normal' id='first-column'>0</TD><TD class='value-normal' id='last-column'>one</TD></TR><TR><TD class='value-normal' id='first-column'>1</TD><TD class='value-normal' id='last-column'>two</TD></TR><TR><TD class='value-normal' id='first-column'>2</TD><TD class='value-normal' id='last-column'>three</TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>6</TD><TD class='value-normal' id='last-column'>Empty String[]</TD></TR></table></TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>InnerObjectList</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>Object[]</TH></TR><TR><TD class='value-normal' id='first-column'>0</TD><TD class='value-normal' id='last-column'>Test String</TD></TR><TR><TD class='value-normal' id='first-column'>1</TD><TD class='value-normal' id='last-column'>12.2324</TD></TR><TR><TD class='value-normal' id='first-column'>2</TD><TD class='value-normal' id='last-column'>9149cae6-b300-44a7-8130-034f742477c4</TD></TR><TR><TD class='value-normal' id='first-column'>3</TD><TD class='value-normal' id='last-column'>1/1/2000 12:00:00 AM</TD></TR><TR><TD class='value-normal' id='first-column'>4</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>Tuple&LTString,String&GT</TH></TR><TR><TD class='value-normal' id='first-column'>Item1</TD><TD class='value-normal' id='last-column'>a</TD></TR><TR><TD class='value-normal' id='first-column'>Item2</TD><TD class='value-normal' id='last-column'>b</TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>5</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>String[]</TH></TR><TR><TD class='value-normal' id='first-column'>0</TD><TD class='value-normal' id='last-column'>one</TD></TR><TR><TD class='value-normal' id='first-column'>1</TD><TD class='value-normal' id='last-column'>two</TD></TR><TR><TD class='value-normal' id='first-column'>2</TD><TD class='value-normal' id='last-column'>three</TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>6</TD><TD class='value-normal' id='last-column'>Empty String[]</TD></TR></table></TD></TR></table>")
                .SetName("Nested Classes"),
            new TestCaseData(Mother.CreateTestStruct(2), "<style type='text/css'> table.alert-table { font-family:Arial,Sans-Serif; font-size:8pt; background-color: #FFFFFF; } th.value-emphasized{ background-color: #E0E0E0; font-weight:bold; font-size:10pt; } td.value-title{ background-color: #A0A0A0; font-size:10pt; font-weight:bold; } td.value-emphasized{ background-color: #D0D0D0; font-weight:bold; } td.value-normal { background-color: #F0F0F0; } td#first-column.value-normal{ background-color: #E0E0E0; } </style><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>TestStruct</TH></TR><TR><TD class='value-normal' id='first-column'>DateProperty</TD><TD class='value-normal' id='last-column'>1/1/2000 12:00:00 AM</TD></TR><TR><TD class='value-normal' id='first-column'>NumberProperty</TD><TD class='value-normal' id='last-column'>Three</TD></TR><TR><TD class='value-normal' id='first-column'>InnerObjectList</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>Object[]</TH></TR><TR><TD class='value-normal' id='first-column'>0</TD><TD class='value-normal' id='last-column'>Test String</TD></TR><TR><TD class='value-normal' id='first-column'>1</TD><TD class='value-normal' id='last-column'>12.2324</TD></TR><TR><TD class='value-normal' id='first-column'>2</TD><TD class='value-normal' id='last-column'>9149cae6-b300-44a7-8130-034f742477c4</TD></TR><TR><TD class='value-normal' id='first-column'>3</TD><TD class='value-normal' id='last-column'>1/1/2000 12:00:00 AM</TD></TR><TR><TD class='value-normal' id='first-column'>4</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>Tuple&LTString,String&GT</TH></TR><TR><TD class='value-normal' id='first-column'>Item1</TD><TD class='value-normal' id='last-column'>a</TD></TR><TR><TD class='value-normal' id='first-column'>Item2</TD><TD class='value-normal' id='last-column'>b</TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>5</TD><TD class='value-normal' id='last-column'><table class='alert-table' cellspacing='1' cellpadding='2' width='100%'><TR><TH class='value-emphasized' id='last-column' colspan='2'>String[]</TH></TR><TR><TD class='value-normal' id='first-column'>0</TD><TD class='value-normal' id='last-column'>one</TD></TR><TR><TD class='value-normal' id='first-column'>1</TD><TD class='value-normal' id='last-column'>two</TD></TR><TR><TD class='value-normal' id='first-column'>2</TD><TD class='value-normal' id='last-column'>three</TD></TR></table></TD></TR><TR><TD class='value-normal' id='first-column'>6</TD><TD class='value-normal' id='last-column'>Empty String[]</TD></TR></table></TD></TR></table>")
                .SetName("Nested Structs"),
            new TestCaseData(Mother.CreateNestedException(2), "")
                .SetName("Exceptions")
        };
        [Test, TestCaseSource("HtmlCases")]
        public void WithHtmlTemplate(object o, string expected)
        {
            Serialize(new FluentAlertSerializer<Html>(), o , expected);
        }
        

        private static void Serialize(IFluentAlertSerializer serializer, object o, string expected)
        {
            var actual = serializer.Serialize(o);
            Debug.Print(actual);
            actual.Should().Be(expected);
        }
    }
}
